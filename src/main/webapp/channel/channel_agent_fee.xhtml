<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns:ui="http://java.sun.com/jsf/facelets"
                template="/resources/template/template.xhtml"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://java.sun.com/jsf/core">

    <ui:define name="content">
        <h:form>
            <p:panel>
                <p:panelGrid columns="2">
                    <p:outputLabel value="Speciality" />
                    <p:autoComplete id="acSpeciality" forceSelection="true" 
                                    value="#{channellingFeeController.speciality}"
                                    required="true"
                                    completeMethod="#{specialityController.completeSpeciality}"
                                    var="spe"
                                    itemLabel="#{spe.name}" 
                                    itemValue="#{spe}" 
                                    style="width: 400px;">
                        <f:ajax  event="itemSelect" execute="acSpeciality" render="tbl"  />
                    </p:autoComplete>  


                    <h:outputLabel  value="Doctor" ></h:outputLabel>
                    <p:autoComplete   forceSelection="true" 
                                      value="#{channellingFeeController.doctor}" id="acDoc"
                                      completeMethod="#{channellingFeeController.completeDoctors}" 
                                      var="mys" itemLabel="#{mys.person.nameWithTitle}" 
                                      itemValue="#{mys}"
                                      converter="stfcon"   >   
                        <f:ajax event="change" execute="acDoc" render="lstSelect gpDetail"  />
                    </p:autoComplete>  

                    <p:outputLabel value="Session" />
                    <p:selectOneListbox  id="lstSelect" converter="sscon"  
                                         value="#{channellingFeeController.session}" style="min-width: 100%;" >
                        <f:selectItems  value="#{channellingFeeController.sessions}" var="ses" 
                                        itemValue="#{ses}" 
                                        itemLabel="#{ses.name}" ></f:selectItems>
                        <f:ajax event="change" render="gpDetail" execute="lstSelect" >
                        </f:ajax>
                    </p:selectOneListbox>

                </p:panelGrid>                

                <p:panel id="gpDetail" >

                    <p:dataTable value="#{agentsFeesController.items}" var="i" id="tbl">
                        <p:column headerText="Speciality">
                            <h:outputLabel value="#{i.serviceSession.staff.speciality.name}"/>
                        </p:column>
                        <p:column headerText="Doctor">
                            <h:outputLabel value="#{i.serviceSession.staff.person.nameWithTitle}"/>
                        </p:column>
                        <p:column headerText="Name">
                            <h:outputLabel value="#{i.serviceSession.name}"/>
                        </p:column>
                        <p:column headerText="Start Time">
                            <h:outputLabel value="#{i.serviceSession.startingTime}"/>
                        </p:column>
                        <p:column headerText="Hospital Fee">
                            <h:outputLabel value="#{i.serviceSession.hospitalFee}"/>
                        </p:column>
                        <p:column headerText="Doctor Fee">
                            <h:outputLabel value="#{i.serviceSession.staffFee}"/>
                        </p:column>
                        <p:column headerText="Agent Fee">
                            <h:outputLabel value="#{i.fee.fee}"/>
                        </p:column>
                    </p:dataTable>

                </p:panel>

            </p:panel>
        </h:form>
    </ui:define>


</ui:composition>
